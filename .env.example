# ============================================================================
# Solr for Moodle - Docker Edition
# Environment Configuration Template
# Version: 3.5.0
# ============================================================================
# Copy this file to .env and configure your values
# DO NOT commit .env to version control!
# ============================================================================

# ============================================================================
# CUSTOMER / PROJECT CONFIGURATION
# ============================================================================
# Used for container naming, core naming, and monitoring labels
CUSTOMER_NAME=moodle_customer

# ============================================================================
# SOLR CONFIGURATION
# ============================================================================
SOLR_VERSION=9.9.0
SOLR_PORT=8983
SOLR_BIND_IP=127.0.0.1

# Heap size (50% of container memory limit is recommended)
# Examples: 1g, 2g, 4g, 8g
SOLR_HEAP_SIZE=2g

# Memory limit for Solr container (should be 2x heap size)
SOLR_MEMORY_LIMIT=4g

# CPU limits
SOLR_CPU_LIMIT=2.0
SOLR_CPU_RESERVATION=0.5

# Solr log level (ERROR, WARN, INFO, DEBUG, TRACE)
SOLR_LOG_LEVEL=INFO

# Auto-commit settings (in milliseconds)
SOLR_AUTO_COMMIT_TIME=15000
SOLR_AUTO_SOFT_COMMIT_TIME=1000

# ============================================================================
# AUTHENTICATION (REQUIRED - Change all passwords!)
# ============================================================================
# Admin user - Full access to all operations
SOLR_ADMIN_USER=admin
SOLR_ADMIN_PASSWORD=CHANGE_ME_SECURE_PASSWORD_MIN_16_CHARS

# Support user - Read-only access + metrics
SOLR_SUPPORT_USER=support
SOLR_SUPPORT_PASSWORD=CHANGE_ME_SECURE_PASSWORD_MIN_16_CHARS

# Customer user - Read + update documents
SOLR_CUSTOMER_USER=customer
SOLR_CUSTOMER_PASSWORD=CHANGE_ME_SECURE_PASSWORD_MIN_16_CHARS

# ============================================================================
# CUSTOM CONFIGURATION DIRECTORY (Optional)
# ============================================================================
# By default, configs are stored in ./config
# Override this to use a different location (e.g., central config management)
# SOLR_CONFIG_DIR=/var/solr-configs/docker/config

# ============================================================================
# HEALTH API CONFIGURATION
# ============================================================================
HEALTH_API_PORT=8888

# ============================================================================
# MONITORING CONFIGURATION
# ============================================================================
# Monitoring mode: none, exporter-only, or full
# - none: No monitoring
# - exporter-only: Only Solr Exporter (for remote Prometheus)
# - full: Full local monitoring stack (Prometheus + Grafana + Alertmanager)
MONITORING_MODE=none

# Solr Exporter
EXPORTER_PORT=9854
EXPORTER_BIND_IP=127.0.0.1

# Prometheus
PROMETHEUS_PORT=9090
PROMETHEUS_BIND_IP=127.0.0.1
PROMETHEUS_RETENTION=30d

# Grafana
GRAFANA_PORT=3000
GRAFANA_BIND_IP=0.0.0.0
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_ROOT_URL=http://localhost:3000

# Alertmanager
ALERTMANAGER_PORT=9093
ALERTMANAGER_BIND_IP=127.0.0.1

# ============================================================================
# BACKUP CONFIGURATION
# ============================================================================
# Backup retention in days
BACKUP_RETENTION_DAYS=30

# Optional: Webhook URL for backup notifications (Slack, MS Teams, etc.)
# BACKUP_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# ============================================================================
# LOG ROTATION CONFIGURATION
# ============================================================================
# Enable log rotation (true/false)
LOG_ROTATION_ENABLED=false

# ============================================================================
# NETWORK CONFIGURATION
# ============================================================================
# Docker network settings (advanced users only)
# FRONTEND_NETWORK_SUBNET=172.20.0.0/24
# BACKEND_NETWORK_SUBNET=172.20.1.0/24

# ============================================================================
# ADVANCED TUNING (Optional)
# ============================================================================
# GC pause time goal (milliseconds)
# SOLR_MAX_GC_PAUSE_MILLIS=150

# G1 heap region size (must be power of 2: 1m, 2m, 4m, 8m, 16m, 32m)
# SOLR_G1_HEAP_REGION_SIZE=32m

# Initiating heap occupancy percent (when to start GC)
# SOLR_INITIATING_HEAP_OCCUPANCY_PERCENT=75

# ============================================================================
# SECURITY SETTINGS
# ============================================================================
# Enable/disable anonymous access to ping endpoint
# SOLR_ANONYMOUS_PING=false

# ============================================================================
# NOTES
# ============================================================================
# Password Security:
#   - Use strong passwords (minimum 16 characters)
#   - Include uppercase, lowercase, numbers, and special characters
#   - Never commit .env to version control
#   - Passwords are hashed using Double SHA-256 with random salt
#
# Resource Planning:
#   - Small deployment: 2GB heap, 4GB total memory
#   - Medium deployment: 4GB heap, 8GB total memory
#   - Large deployment: 8GB heap, 16GB total memory
#   - Rule of thumb: Total memory = 2x heap size
#
# Monitoring Modes:
#   - Use "none" for production without monitoring
#   - Use "exporter-only" when connecting to remote Prometheus
#   - Use "full" for local development/testing with full monitoring stack
#
# For more information, see README.md
# ============================================================================
